import{a as g,o as a,b as u,e as n,t as c,f as d,w as p,v as b}from"./entry.2879f90d.js";function y(t){return String.fromCharCode.apply(null,new Uint8Array(t))}function h(t){const e=new ArrayBuffer(t.length),o=new Uint8Array(e);for(let s=0,i=t.length;s<i;s++)o[s]=t.charCodeAt(s);return e}const w={data(){return{keyPair:null,publicKey:"",message:"",signed:"",result:""}},methods:{async creatKeys(){console.log("creatECDSA Key"),this.keyPair=await window.crypto.subtle.generateKey({name:"ECDSA",namedCurve:"P-384"},!0,["sign","verify"]);const t=await window.crypto.subtle.exportKey("spki",this.keyPair.publicKey),e=y(t),o=window.btoa(e);this.publicKey=`-----BEGIN PUBLIC KEY-----
${o}
-----END PUBLIC KEY-----`,console.log("pk",this.keyPair.publicKey,e,new Uint8Array(t))},async sign(){console.log("sign message",this.message);let e=new TextEncoder().encode(this.message),o=await window.crypto.subtle.sign({name:"ECDSA",hash:{name:"SHA-384"}},this.keyPair.privateKey,e);const s=y(o);this.signed=window.btoa(s),console.log("sign",this.signed)},async verify(){const t=window.atob(this.signed),e=h(t);let s=new TextEncoder().encode(this.message);this.result=await window.crypto.subtle.verify({name:"ECDSA",hash:{name:"SHA-384"}},this.keyPair.publicKey,e,s),console.log("verify:",this.result)}},mounted(){}},m=n("button",null,"\u5BFC\u51FAECDSA\u79D8\u94A5",-1),f=n("button",null,"\u5BFC\u5165ECDSA\u79D8\u94A5",-1),v=n("p",null,"\u516C\u94A5\u4FE1\u606F\uFF1A",-1),C={key:0},A=n("p",null,"\u660E\u6587\u4FE1\u606F\uFF1A",-1),K=n("p",null,"\u7B7E\u540D\u540E\u4FE1\u606F\uFF1A",-1),_={key:0},k=n("p",null,"\u7B7E\u540D\u9A8C\u8BC1\u7ED3\u679C\uFF1A",-1);function E(t,e,o,s,i,r){return a(),u("div",null,[n("div",null,[n("button",{onClick:e[0]||(e[0]=(...l)=>r.creatKeys&&r.creatKeys(...l))},"\u521B\u5EFAECDSA\u79D8\u94A5"),m,f]),n("div",null,[v,i.publicKey.length>0?(a(),u("p",C,c(i.publicKey),1)):d("",!0)]),n("div",null,[A,p(n("textarea",{"onUpdate:modelValue":e[1]||(e[1]=l=>i.message=l)},null,512),[[b,i.message]])]),n("div",null,[K,i.signed.length>0?(a(),u("p",_,c(i.signed),1)):d("",!0)]),n("div",null,[k,n("p",null,c(i.result),1)]),n("div",null,[n("button",{onClick:e[2]||(e[2]=(...l)=>r.sign&&r.sign(...l))},"\u4F7F\u7528\u79C1\u94A5\u8FDB\u884C\u7B7E\u540D"),n("button",{onClick:e[3]||(e[3]=(...l)=>r.verify&&r.verify(...l))},"\u4F7F\u7528\u516C\u94A5\u8FDB\u884C\u9A8C\u8BC1")])])}const x=g(w,[["render",E]]);export{x as default};
